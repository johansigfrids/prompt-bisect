(()=>{"use strict";var e={426:function(e,t,r){var n=r("893"),l=r("294"),s=r("745");let i=async(e,t,r)=>{let n=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:t,messages:[{role:"user",content:r}],max_completion_tokens:1})});return await n.json()},a=(e,t)=>{let r=e.split("\n"),n=[],l=Math.floor(r.length/t);for(let e=0;e<t;e++){let s=e*l,i=e===t-1?r.length:(e+1)*l;n.push(r.slice(s,i).join("\n"))}return n},o=async function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4?arguments[4]:void 0;if(n>10)throw Error("Maximum recursion depth reached. Unable to bisect further.");l&&l(r);let s=await i(e,t,r),u=!1;if("error"in s){if("invalid_prompt"===s.error.code)u=!0;else throw Error(`OpenAI API error: ${s.error.message}`)}if(!u)return{result:"no_segment_found",message:"No invalid_prompt issues were found in the provided prompt."};let c=(r.match(/\n/g)||[]).length;if(0===c)return{result:"segment_found",problematicSegment:r};let[d,p]=a(r,2),m=await o(e,t,d,n+1,l);if("segment_found"===m.result)return m;let h=await o(e,t,p,n+1,l);if("segment_found"===h.result)return h;if(c>=3){let[s,i]=a(r,4),u=await o(e,t,s,n+1,l);if("segment_found"===u.result)return u;let c=await o(e,t,i,n+1,l);if("segment_found"===c.result)return c}return{result:"segment_found",problematicSegment:r}},u=e=>{let{bisectResult:t,onBack:r}=e;return(0,n.jsxs)("div",{className:"bisect-result",children:[(0,n.jsx)("h2",{children:"Result:"}),"segment_found"===t.result?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Problematic Segment Found"}),(0,n.jsx)("div",{className:"segment",children:t.problematicSegment})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("p",{children:t.message})}),(0,n.jsx)("button",{type:"button",onClick:r,className:"back-button",children:"Back"})]})},c=e=>{let{message:t,onBack:r}=e;return(0,n.jsxs)("div",{className:"error",children:[(0,n.jsx)("h2",{children:"Error:"}),(0,n.jsx)("p",{children:t}),(0,n.jsx)("button",{type:"button",onClick:r,className:"back-button",children:"Back"})]})},d=[{value:"o1-mini",label:"o1-mini"},{value:"o1-preview",label:"o1-preview"},{value:"gpt-4o",label:"gpt-4o"},{value:"gpt-4o-mini",label:"gpt-4o-mini"},{value:"gpt-4",label:"gpt-4"}],p=e=>{let{onSubmit:t,initialData:r}=e,[s,i]=(0,l.useState)((null==r?void 0:r.apiKey)||""),[a,o]=(0,l.useState)((null==r?void 0:r.prompt)||""),[u,c]=(0,l.useState)((null==r?void 0:r.selectedModel)||d[0].value);return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({apiKey:s,prompt:a,selectedModel:u})},className:"form",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"apiKey",children:"OpenAI API Key:"}),(0,n.jsx)("input",{type:"text",id:"apiKey",value:s,onChange:e=>i(e.target.value),placeholder:"Enter your OpenAI API key",required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"model",children:"Select Model:"}),(0,n.jsx)("select",{id:"model",value:u,onChange:e=>c(e.target.value),required:!0,children:d.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"prompt",children:"Prompt:"}),(0,n.jsx)("textarea",{id:"prompt",value:a,onChange:e=>o(e.target.value),placeholder:"Enter your prompt",required:!0})]}),(0,n.jsx)("button",{type:"submit",children:"Submit"})]})},m=e=>{let{currentSegment:t}=e;return(0,n.jsxs)("div",{className:"loading",children:[(0,n.jsx)("h2",{children:"Processing segments... Please wait."}),t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Current Segment:"}),(0,n.jsx)("pre",{className:"current-segment",children:t})]})]})},h=document.getElementById("root");h&&s.createRoot(h).render((0,n.jsx)(l.StrictMode,{children:(0,n.jsx)(()=>{let[e,t]=(0,l.useState)(null),[r,s]=(0,l.useState)(""),[i,a]=(0,l.useState)(!1),[d,h]=(0,l.useState)(""),[f,g]=(0,l.useState)(void 0),v=async e=>{let{apiKey:r,prompt:n,selectedModel:l}=e;if(g(e),s(""),t(null),h(""),!r){s("Please enter your OpenAI API key.");return}if(!n){s("Please enter a prompt.");return}a(!0);try{let e=await o(r,l,n,0,e=>{h(e)});t(e)}catch(e){s(e.message||"Failed to fetch the response. Please try again later.")}finally{a(!1),h("")}},x=()=>{s(""),t(null),h("")};return(0,n.jsxs)("div",{className:"content",children:[(0,n.jsx)("h1",{children:"OpenAI Prompt Bisect"}),(0,n.jsx)("p",{children:"The content filters for the o1 models can trip up on smallest things. This app helps find what part of a prompt is causing a invalid_prompt error. It will repeatedly call the OpenAI API with smaller and smaller sections of the prompt until it finds the problematic part."}),(0,n.jsx)("p",{children:"It uses a binary search and limits completions tokens to 1 in order to cut down on the cost of doing the search, but be mindful that it can still end up expensive for o1 models."}),i?(0,n.jsx)(m,{currentSegment:d}):r?(0,n.jsx)(c,{message:r,onBack:x}):e?(0,n.jsx)(u,{bisectResult:e,onBack:x}):(0,n.jsx)(p,{onSubmit:v,initialData:f})]})},{})}))}},t={};function r(n){var l=t[n];if(void 0!==l)return l.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.m=e,r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},(()=>{var e=[];r.O=function(t,n,l,s){if(n){s=s||0;for(var i=e.length;i>0&&e[i-1][2]>s;i--)e[i]=e[i-1];e[i]=[n,l,s];return}for(var a=1/0,i=0;i<e.length;i++){for(var n=e[i][0],l=e[i][1],s=e[i][2],o=!0,u=0;u<n.length;u++)(!1&s||a>=s)&&Object.keys(r.O).every(function(e){return r.O[e](n[u])})?n.splice(u--,1):(o=!1,s<a&&(a=s));if(o){e.splice(i--,1);var c=l();void 0!==c&&(t=c)}}return t}})(),r.rv=function(){return"1.0.10"},(()=>{var e={980:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var l=n[0],s=n[1],i=n[2],a,o,u=0;if(l.some(function(t){return 0!==e[t]})){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(i)var c=i(r)}for(t&&t(n);u<l.length;u++)o=l[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},n=self.webpackChunkrsbuild_react_ts=self.webpackChunkrsbuild_react_ts||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.ruid="bundler=rspack@1.0.10";var n=r.O(void 0,["361"],function(){return r("426")});n=r.O(n)})();